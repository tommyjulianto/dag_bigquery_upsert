{"dag_name": "dag_bigquery_upsert", "name_report": "bigquery_upsert_test", "csv_path": "/home/airflow/gcs/dags", "department": "data", "link_bucket": "https://storage.cloud.google.com", "schema_file": "schemas/schema_upsert_data.json", "fail_safe": 0, "bq_dataset_primary": "dwh_staging", "bq_table_primary": "users", "bq_dataset_staging": "dwh_staging", "bq_table_staging": "users_staging", "bq_destination": "dwh-koinworks", "bq_table_primary_key": "id", "bq_location": "asia-southeast1", "default_args": {"owner": "Tommy", "depends_on_past": false, "start_date": "2019-10-03", "email": ["tommy.julianto@koinworks.com"], "email_on_failure": true, "email_on_retry": false, "retries": 1, "start_date_format": "%Y-%m-%d", "schedule_interval": "@once", "catchup": false}, "task": [{"task_id": "check_fail_safe_and_update_last_sync"}, {"task_id": "extract_users", "sql": "select * from users", "param_1": 7, "param_2": 15}, {"task_id": "pyspark_job", "pyspark_job": "gs://spectre-dump-staging/dump_report/data/bigquery_upsert_test/test_bigquery_upsert.py", "cluster_name": "dataproc-staging-cluster"}, {"task_id": "gcs_to_BigQuery_users_staging", "pyspark_job": "gs://spectre-dump-staging/dump_report/data/bigquery_upsert_test/test_bigquery_upsert.py", "destination_table": "dwh-koinworks:dwh_staging.users_staging", "schema_fields": null, "schema_object": "schemas/schema_upsert_data.json", "source_format": "CSV", "create_disposition": "CREATE_IF_NEEDED", "skip_leading_rows": 0, "write_disposition": "WRITE_TRUNCATE", "max_bad_records": 0, "ignore_unknown_values": true, "field_delimiter": "|"}, {"task_id": "gcs_to_BigQuery_users", "pyspark_job": "gs://spectre-dump-staging/dump_report/data/bigquery_upsert_test/test_bigquery_upsert.py", "destination_table": "dwh-koinworks:dwh_staging.users", "schema_fields": null, "schema_object": "schemas/schema_upsert_data.json", "source_format": "CSV", "create_disposition": "CREATE_IF_NEEDED", "skip_leading_rows": 0, "write_disposition": "WRITE_TRUNCATE", "max_bad_records": 0, "ignore_unknown_values": true, "field_delimiter": "|"}, {"task_id": "gcs_to_BigQuery_users_if_fail_safe", "pyspark_job": "gs://spectre-dump-staging/dump_report/data/bigquery_upsert_test/test_bigquery_upsert.py", "destination_table": "dwh-koinworks:dwh_staging.users", "schema_fields": null, "schema_object": "schemas/schema_upsert_data.json", "source_format": "CSV", "create_disposition": "CREATE_IF_NEEDED", "skip_leading_rows": 0, "write_disposition": "WRITE_TRUNCATE", "max_bad_records": 0, "ignore_unknown_values": true, "field_delimiter": "|"}, {"task_id": "push_merged_fields", "provide_context": true}, {"task_id": "check_is_table_exist"}, {"task_id": "check_is_fail_safe"}, {"task_id": "merge_bq_data", "use_legacy_sql": false, "merge_query": ["MERGE {}.{} P", "USING {}.{} S", "ON P.{} = S.{}", "WHEN MATCHED THEN", "    UPDATE SET {}", "WHEN NOT MATCHED THEN", "    INSERT ({}) VALUES({})"]}, {"task_id": "save_airflow_variable"}], "extract_date": "2019-10-22 03:49:38.700792", "last_sync": "2019-10-22 03:49:38.700792"}
